{% extends "adminlte/common_list.html" %}
{% load adminlte_tags %}
{% load static %}
{% block content_title %}
    {{ page_title }}
{% endblock %}

{% block base_head_style %}
    <style type="text/css">
        input[type='checkbox'] {
            width: 18px;
            height: 18px;
            cursor: pointer;
        }
body {
  font-family: Helvetica Neue, Arial, sans-serif;
  font-size: 14px;
  color: #444;
}

table {
  border: 2px solid #42b983;
  border-radius: 3px;
  background-color: #fff;
}

th.active {
  color: #ffff00;
}

th.active .arrow {
  opacity: 1;
}

.arrow {
  display: inline-block;
  vertical-align: middle;
  width: 0;
  height: 0;
  margin-left: 5px;
  opacity: 0.66;
}

.arrow.asc {
  border-left: 4px solid transparent;
  border-right: 4px solid transparent;
  border-bottom: 4px solid #fff;
}

.arrow.dsc {
  border-left: 4px solid transparent;
  border-right: 4px solid transparent;
  border-top: 4px solid #fff;
}
    </style>

<style type="text/css">
*{ margin:0; padding:0;}
body { font:12px/1.8 Arial; color:#666;}
ul,li{ list-style:none;}
h1.tit-h1 { font-size:38px; text-align:center; margin:30px 0 15px; color:#f60;}
.go-back{ text-align:center; border-top:1px dashed #ccc; padding:10px; margin-top:20px; font-size:40px;}
.wrap{border:1px dashed #ccc; background:#f8f8f8; padding:20px;}

.screen{width:800px; margin:30px auto 50px; border:1px solid #47b4eb; }
.checkedBox{width:770px;height:29px; border-bottom:1px solid #47b4eb;background:#e7f1fe;padding:0 15px 0 15px; font-size:12px;overflow:hidden;}
.checkedBox dt{color:#454444;line-height:28px;float:left;}
.checkedBox dd{float:left;padding:6px 8px 0 0;}
.checkedBox dd a{color:#608acc;background:url(/static/assets/1.gif) right #fff no-repeat;overflow:hidden; display:block; float:left;height:15px;line-height:15px;border:1px solid #b4c6dc;padding:0 20px 0 5px;}
.checkedBox dd a:hover{color:#47b4eb;background:url(/static/assets/2.gif) right #fff no-repeat;border:1px solid #79bfe2;}
.screenList{font-size:12px;padding:0 10px 0 10px;}
.screenItem{ width:780px; border-bottom:1px solid #999999; overflow:hidden;zoom:1;}
.screenItem dt{ float:left; line-height:28px;}
.screenItem dd{ float:left; line-height:28px; padding-right:8px;}
.screenList a{padding-left:5px;}
</style>
{% endblock %}

{% block content %}
    <div class="row" id="mydataPageVue">
        <div class="col-xs-12">
            <div class="box box-success"><!-- box-success 这种东西是颜色-->
                <div class="box-header">
                    <h3 class="box-title">
                        列表
                    </h3>
                </div><!-- /.box-header -->
                <div class="box-body">
                    <div id="example_wrapper" class="dataTables_wrapper form-inline dt-bootstrap">
                        <div class="row">
                            {% if list_filter %}
                                <div class="col-xs-12 col-sm-12">
                                    <div id='SlKeyListFilter' class="sl-key">
                                        {% for k in list_filter %}
                                            <span id="list_filter_{{ k.id }}">{{ k.verbose_name }} 选项:</span>
                                            <select onchange='mydataPageVue.search_ListFilter(this)' name="{{ k.id }}" data-page="1">
                                              {% for key in k.get_choices %}
                                                  <option value={{ key.0 }}>{{ key.1 }}</option>
                                              {% endfor %}
                                            </select>
                                        {% endfor %}
                                    </div>
                                </div>
                            {% endif %}
                            {% if all_list_display %}
                                <div class="col-xs-12 col-sm-6">
                                    {% for display_buttons in all_list_display %}
                                        <button class="btn btn-primary"
                                                id="{{ display_buttons.id }}"
                                                data-action="{{ display_buttons.action }}"
                                                v-on:click="{{ display_buttons.type }}">
                                            <i id="{{ display_buttons.id }}"
                                               data-action="{{ display_buttons.action }}"
                                               class="fa {{ display_buttons.icon }}"></i>
                                            {{ display_buttons.name }}
                                        </button>
                                    {% endfor %}
                                </div>
                            {% endif %}
                            {% if search %}

                                <div id="SlKeySearch" class="col-xs-12 col-sm-6 ">
                                    <div class="input-group pull-right">
                                        <input type="text" name="{{ search.name }}"
                                               id="tableSearch_search"
                                               class="form-control input-sm pull-right"
                                               style="width: 150px;"
                                               placeholder="关键字"
                                               v-on:keypress.13="search">

                                        <div class="input-group-btn">
                                            <button class="btn btn-sm btn-default"
                                                    data-name="search"
                                                    data-page="1"
                                                    v-on:click="resetSearch">
                                                <i class="fa fa-times-circle"></i>
                                            </button>
                                            <button class="btn btn-sm btn-default"
                                                    data-page="1"
                                                    v-on:click="search">
                                                <i class="fa fa-search"></i>
                                            </button>
                                        </div>
                                    </div>
                                </div>
                            {% endif %}
                        </div>
                        <div class="row">
                            <div class="col-sm-12">
                                <table id="example" class="table table-bordered table-hover dataTable" role="grid" aria-describedby="example_info">
                                    <thead>
                                        <tr role="row">
                                            <th class="sorting_asc" style="width:30px;">
                                                #
                                            </th>
                                            <th style="text-align: center;width:40px;">
                                                <input type="checkbox"
                                                       name="checkboxAllRow"
                                                       v-on:click="toggleAllBox"/>
                                            </th>
                                            <th class="sorting" v-for="key in Page_Columns"
                                                @click="sortBy(key[0])"
                                                :class="{active: sortKey == key[0]}">
                                                {!! key[1] | capitalize !!}
                                                <span class="arrow"
                                                      :class="sortOrders[key[0]] > 0 ? 'asc' : 'dsc'">
                                                </span>
                                            </th>
                                        </tr>

                                    </thead>
                                    <tbody>
                                        <template v-for="item in Page_Items
                                            | filterBy filterKey
                                            | orderBy sortKey sortOrders[sortKey]">
                                            <tr role="row" class="even #[item.ClassYs]">
                                                <td style="width:30px;">#[$index+1]</td>
                                                <td style="width:40px;text-align:center">
                                                    <input type="checkbox" class="minimal"
                                                           name="checkboxRow"
                                                           value="#[item.id]"/>
                                                </td>
                                                {% for field in list_display %}
                                                    {% if field.id == 'id' %}
                                                        <td>
                                                            {% for display_buttons in list_display_buttons %}
                                                                <button class="btn btn-primary"
                                                                        data-pk="#[item.id]"
                                                                        data-action="{{ display_buttons.action }}"
                                                                        v-on:click="{{ display_buttons.type }}">
                                                                    <i data-pk="#[item.id]"
                                                                       data-action="{{ display_buttons.action }}"
                                                                       class="fa {{ display_buttons.icon }}"></i>
                                                                    {{ display_buttons.name }}
                                                                </button>
                                                            {% endfor %}
                                                            {!! item.StatusButton !!}
                                                        </td>
                                                    {% elif field.type == 'Dialog'%}
                                                        <td>
                                                            <sapn href="javascript:void(0);"
                                                                  data-pk="#[item.id]"
                                                                  data-field="{{ field.id }}"
                                                                  v-on:MouseMove="Dialog_restart_pt_deploy"
                                                                  v-on:MouseOut="re_Dialog">
                                                                {!! item.{{ field.id }}[0] !!}
                                                            </sapn>
                                                        </td>
                                                    {% else %}
                                                        <td>
                                                            {!! item.{{ field.id }} !!}
                                                        </td>
                                                    {% endif %}
                                                {% endfor %}
                                            </tr>
                                        </template>
                                    </tbody>
                                    <tfoot>
                                        <tr>
                                          <th class="sorting_asc" style="width:30px;">
                                              #
                                          </th>
                                          <th style="text-align: center;width:40px;">
                                          </th>
                                          <th class="sorting" v-for="key in Page_Columns"
                                              @click="sortBy(key[0])"
                                              :class="{active: sortKey == key[0]}">
                                              {!! key[1] | capitalize !!}
                                              <span class="arrow"
                                                    :class="sortOrders[key[0]] > 0 ? 'asc' : 'dsc'">
                                              </span>
                                          </th>
                                      </tr>
                                    </tfoot>
                                </table>
                            </div>
                        </div>
                        <div class="row">
                            <div class="col-sm-5 ">
                                <div class="dataTables_info " id="example_info" role="status" aria-live="polite">
                                    共 #[Page_TotalCount] 条数据, 每页 #[Page_PageSize] 条,
                                    #[Page_PageNumber]/#[Page_TotalPage]&nbsp;&nbsp;
                                </div>
                            </div>
                            <div class="col-sm-7">
                                <div class="dataTables_paginate paging_simple_numbers" id="example_paginate">
                                    <ul class="pagination pagination-sm no-margin pull-right">
                                        <li v-if="Page_TotalPage > 1">
                                            <a href="javascript:void(0);"
                                               page="1"
                                               v-on:click="page">
                                                首页
                                            </a>
                                        </li>
                                        <template v-if="Page_TotalPage == 1">
                                            <li class="disabled">
                                                <a href="javascript:void(0);">
                                                    首页
                                                </a>
                                            </li>
                                        </template>
                                        <li v-if="Page_PageNumber > 1">
                                            <a href="javascript:void(0);"
                                               page="#[Page_PageNumber-1]"
                                               v-on:click="page">
                                                上页
                                            </a>
                                        </li>
                                        <template v-if="Page_PageNumber == 1">
                                            <li class="disabled">
                                                <a href="javascript:void(0);">
                                                    上页
                                                </a>
                                            </li>
                                        </template>
                                        <li v-if="Page_PageNumber < Page_TotalPage">
                                            <a href="javascript:void(0);"
                                               page="#[Page_PageNumber+1]"
                                               v-on:click="page">
                                                下页
                                            </a>
                                        </li>
                                        <template v-if="Page_PageNumber == Page_TotalPage">
                                            <li class="disabled">
                                                <a href="javascript:void(0);">
                                                    下页
                                                </a>
                                            </li>
                                        </template>
                                        <li v-if="Page_TotalPage > 1">
                                            <a href="javascript:void(0);"
                                               page="#[Page_TotalPage]"
                                               v-on:click="page">
                                                末页
                                            </a>
                                        </li>
                                        <template v-if="Page_TotalPage == 1">
                                            <li class="disabled">
                                                <a href="javascript:void(0);">
                                                    末页
                                                </a>
                                            </li>
                                        </template>
                                    </ul>
                                </div>
                            </div>
                        </div>
                    </div>
                </div><!-- /.box-body -->
                <div class="box-footer">
                    <div id="rbox-footer_status">
                        <!-- 显示返回的 消息地方. -->
                    </div>
                    <div>
                        注1:这里能添加注释 .需要在html中修改
                        注2:添加等操作. 需要从在js中修改

                    </div>
                </div><!-- /.box-footer -->
            </div><!-- /.box -->
        </div><!-- /.col -->
        <div class="col-md-12">
            <!-- 添加test层开始 -->
            <a id='row_detail' data-toggle="modal" data-keyboard="false"
               data-target="#row_detail_dt" >
            </a>
            <div class="modal fade bs-modal-lg" data-backdrop="static" id="row_detail_dt" tabindex="-1" role="dialog" aria-hidden="true" aria-labelledby="myModalLabel">
                <div class="modal-dialog modal-lg" role="document">
                    <div class="modal-content">
                        <div id="do_add_form" class="form-horizontal">
                            <div class="modal-header">
                                <button type="button" onclick="" class="close"  data-dismiss="modal" aria-label="Close"><span aria-hidden="true">&times;</span></button>
                                <h4 class="modal-title detail_title" id="myModalLabel" style="font-weight: normal;">修改内容</h4>
                            </div>
                            <div class="modal-body detail_body">
                            </div>
                            <div class="modal-footer detail_footer">
                                <button type="button" onclick="CancelModal('#row_detail_dt')" class="btn btn-default" data-dismiss="modal">取 消</button>
                                <button type="button" onclick="SubmitModal('#row_detail_dt', '#row_detail_dt_status','row_detail_dt');" class="btn btn-primary">提 交</button>
                                <span id="row_detail_dt_status" style="color: #EC6868;"></span>
                            </div>
                        </div>
                    </div>
                </div>
            </div>
            <!-- 添加test层结束 -->
        </div>
    </div>
{% endblock %}

{% block base_foot_page_script %}
    <script src="{% static 'crm/common-list-page-base.js' %}"
            type="text/javascript">
    </script>
    <script>
        // 渲染 列表 勿动
        mydataPageVue.Page_Columns = [
            {% for i in list_display %}
                ['{{ i.id }}', '{{ i.verbose_name }}'],
            {% endfor %}
        ];
        // 模拟数据
        // mydataPageVue.Page_Items = [
        //     {
        //         "course": '课程名称',
        //         "semester": '13',
        //         "start_date": '12',
        //         "graduate_date": '23',
        //         "student_num": '33',
        //         "teachers": '123',
        //         "id": '9999',
        //     }
        // ]
        // 正式时.需要开启
        $('#refresh').click()
    </script>
{% endblock %}